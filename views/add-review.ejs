<%- include("partials/header.ejs") %>

    <% if (locals.oldReview) { %>
        <form action="/editReview/<%= oldReview.id %>" method="post">
            <input type="text" name="bookTitle" id="bookTitle" value="<%= oldReview.title %>">
            <textarea name="bookReview" id="bookReview"><%= oldReview.description %></textarea>
            <input type="number" name="bookRating" id="bookRating" min="0" max="10" value="<%= oldReview.rating %>">
            <input type="file" name="bookCover" id="bookCover" onchange="encodeToBase64(this)">
            <input type="hidden" name="coverData" id="coverData" value="<%= oldReview.cover %>">
            <button type="submit">Send</button>
        </form>
    <% } else { %>
        <div class="container border rounded my-5 p-5">
            <form class="px-5 py-5" action="/addReview" method="post">
                <div class="input-group mb-4">
                    <span class="input-group-text bg-success text-light" id="basic-addon1">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-bookmark-fill" viewBox="0 0 16 16">
                            <path d="M2 2v13.5a.5.5 0 0 0 .74.439L8 13.069l5.26 2.87A.5.5 0 0 0 14 15.5V2a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2"/>
                        </svg>
                    </span>
                    <input type="text" name="bookTitle" id="bookTitle" class="form-control" placeholder="Book title..." aria-label="Title" aria-describedby="basic-addon1">
                </div>
                <div class="input-group mb-4">
                    <span class="input-group-text bg-success text-light" id="basic-addon1">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-card-text" viewBox="0 0 16 16">
                            <path d="M14.5 3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5zm-13-1A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h13a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2z"/>
                            <path d="M3 5.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5M3 8a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9A.5.5 0 0 1 3 8m0 2.5a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1h-6a.5.5 0 0 1-.5-.5"/>
                        </svg>
                    </span>
                    <textarea class="form-control" name="bookDescription" id="bookDescription" aria-label="Book Description" maxlength="510" rows="4" placeholder="Book description..."></textarea>
                </div>
                <div class="input-group mb-4">
                    <span class="input-group-text bg-success text-light" id="basic-addon1">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-award-fill" viewBox="0 0 16 16">
                            <path d="m8 0 1.669.864 1.858.282.842 1.68 1.337 1.32L13.4 6l.306 1.854-1.337 1.32-.842 1.68-1.858.282L8 12l-1.669-.864-1.858-.282-.842-1.68-1.337-1.32L2.6 6l-.306-1.854 1.337-1.32.842-1.68L6.331.864z"/><path d="M4 11.794V16l4-1 4 1v-4.206l-2.018.306L8 13.126 6.018 12.1z"/>
                        </svg>
                    </span>
                    <input type="number" name="bookRating" id="bookRating" class="form-control" placeholder="Book rating..." aria-label="Rating" aria-describedby="basic-addon1" min="0" max="10">
                </div>
                <div class="input-group mb-4">
                    <input type="file" class="form-control" name="bookCover" id="bookCover" onchange="encodeToBase64(this)">
                    <label class="input-group-text bg-success text-light" for="bookCover">Upload</label>
                </div>
                <div class="input-group mb-4">
                    <span class="input-group-text bg-success text-light">Review Body &nbsp; 
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-body-text" viewBox="0 0 16 16">
                            <path fill-rule="evenodd" d="M0 .5A.5.5 0 0 1 .5 0h4a.5.5 0 0 1 0 1h-4A.5.5 0 0 1 0 .5m0 2A.5.5 0 0 1 .5 2h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5m9 0a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5m-9 2A.5.5 0 0 1 .5 4h3a.5.5 0 0 1 0 1h-3a.5.5 0 0 1-.5-.5m5 0a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5m7 0a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 0 1h-3a.5.5 0 0 1-.5-.5m-12 2A.5.5 0 0 1 .5 6h6a.5.5 0 0 1 0 1h-6a.5.5 0 0 1-.5-.5m8 0a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5m-8 2A.5.5 0 0 1 .5 8h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5m7 0a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5m-7 2a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 0 1h-8a.5.5 0 0 1-.5-.5m0 2a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 0 1h-4a.5.5 0 0 1-.5-.5m0 2a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 0 1h-2a.5.5 0 0 1-.5-.5"/>
                        </svg>
                    </span>
                    <textarea class="form-control" name="bookReview" id="bookReview" aria-label="Review Body" rows="10"></textarea>
                </div>
                <input type="hidden" name="coverData" id="coverData">
                <button class="btn btn-success my-3" type="submit">Send &nbsp;
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-send-fill" viewBox="0 0 16 16">
                        <path d="M15.964.686a.5.5 0 0 0-.65-.65L.767 5.855H.766l-.452.18a.5.5 0 0 0-.082.887l.41.26.001.002 4.995 3.178 3.178 4.995.002.002.26.41a.5.5 0 0 0 .886-.083zm-1.833 1.89L6.637 10.07l-.215-.338a.5.5 0 0 0-.154-.154l-.338-.215 7.494-7.494 1.178-.471z"/>
                    </svg>
                </button>
            </form>
        </div>
    <% } %>

    <script>
        function encodeToBase64(image){
            let file = image.files[0];
            const reader = new FileReader();
            reader.onloadend = () => {
                console.log("Result", reader.result);
                document.getElementById("coverData").value = reader.result
            }
            reader.readAsDataURL(file);
        }
    </script>

<%- include("partials/footer.ejs") %>